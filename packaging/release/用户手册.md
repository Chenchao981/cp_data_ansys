# 🎉 CP数据分析工具 - 用户手册

> 适用于 **release** 目录的极简发行版（`app.pyz` + 批处理脚本），体积小、操作简单。

## 📂 目录

1. 🚀 [快速开始](#快速开始)
2. 🎬 [启动程序](#启动程序)
3. 🖱️ [界面操作](#界面操作)
4. 📊 [查看数据](#查看数据)
5. 🤖 [功能一览](#功能一览)
6. ❓ [常见问题](#常见问题)

---

## 🚀 快速开始

### 环境要求

- Windows 10/11 (64-bit) 🪟
- **Anaconda3** (推荐) 🐍 或 Python 3.8+

### 三步上手

1. **解压** `release` 文件夹到任意位置（建议非系统盘📁）
2. **双击** `install_anaconda.bat`（首次运行必做✅）
   - 自动检测环境并安装 3 个必要包：`PyQt5`、`seaborn`、`openpyxl`
   - 全程自动化，无需人工输入⌨️
3. **双击** `start.bat` 运行程序
   - 出现主界面即表示安装成功 🎉

> ⚡ **提示**：第一次运行后可将 `start.bat` 固定到任务栏，启动更快捷！

---

## 🎬 启动程序

### 启动方式

| 方法 | 操作 | 说明 |
|---|---|---|
| **推荐** | 双击 `start.bat` | 自动设置编码并启动 👍 |
|          | 或者把start.bat发送快捷方式到桌面 | 方便快速打开程序     |

### 启动成功标志

- 出现 PyQt5 图形界面窗口 🖼️
- 窗口标题显示"CP数据分析工具"
- 界面包含文件选择、按钮等控件

---

## 🖱️ 界面操作

### 主界面布局

```
┌─────────────────────────────────────┐
│  🔬 CP数据分析工具                    │
├─────────────────────────────────────┤
│  📁 输入文件夹: [选择文件夹...]        │
│  📂 输出文件夹: [选择文件夹...]        │
├─────────────────────────────────────┤
│  🧹 [开始清洗数据]  📊 [生成图表]      │
├─────────────────────────────────────┤
│  📋 处理日志显示区域                  │
│                                     │
└─────────────────────────────────────┘
```

### 操作步骤

1. **选择输入文件夹** 📁
   - 点击"选择文件夹..."按钮
   - 选择包含 `.txt` 或 `.dcp` 文件的目录
   - 支持递归扫描子文件夹

2. **选择输出文件夹** 📂
   - 点击输出路径的"选择文件夹..."
   - 或使用默认路径（桌面自动生成文件夹）

3. **开始数据清洗** 🧹
   - 点击"开始清洗数据"按钮
   - 观察日志区域的处理进度
   - 等待"清洗完成"提示

4. **生成分析图表** 📊
   - 数据清洗完成后，"生成图表"按钮自动启用
   - 点击生成交互式 HTML 图表
   - 完成后会显示输出文件夹路径

---

## 📊 查看数据

### 输出文件位置

程序会在输出目录创建以下结构：

```
📂 批次号_YYYYMMDD_HHMMSS/
├── 📄 cleaned_data.csv          ← 清洗后数据
├── 📈 yield_chart_*.html        ← 良率图
├── 📦 boxplot_*.html           ← 箱体图  
├── 🔄 summary_boxplot.html     ← 汇总图
└── 📋 processing_log_*.log     ← 处理日志
```

### 查看方式

1. **CSV数据文件** 📄
   - 用 Excel 或记事本打开 `cleaned_data.csv`
   - 查看清洗后的结构化数据

2. **HTML图表文件** 📈
   - 双击 `.html` 文件用浏览器打开
   - 推荐使用 Chrome/Edge 浏览器
   - 支持交互操作：缩放、筛选、导出

3. **处理日志** 📋
   - 用记事本打开 `.log` 文件
   - 了解处理过程和异常信息

### 图表交互功能（重要）

- 🖱️ **鼠标悬停**：显示具体数值
- 🔍 **点击图例**：隐藏/显示数据系列  
- 📷 **图片下载**：右上角，最左边的按钮
- 🏠 **复位**：图表复位还原

---

## 🤖 功能一览

### 核心功能

- 🧹 **智能数据清洗**
  - 自动识别 DCP 文件格式
  - 异常值检测与标记（IQR方法）
  - 单位标准化转换（µA→A等）

- 📊 **统计分析**
  - 良率计算（基于规格限）
  - 分布特征分析
  - 批次间对比

- 📈 **可视化图表**
  - 良率趋势图（折线图）
  - 数据分布图（箱体图）
  - 多批次汇总图

### 数据处理特点

- 🚀 **批量处理**：支持多文件、递归子目录
- 🔄 **自动化**：一键完成清洗到图表生成
- 🗂️ **智能归档**：输出文件夹自动命名
- 📋 **完整日志**：记录所有处理步骤

---

## ❓ 常见问题

### 安装相关

**Q: 程序无法启动？** 🚫

- **A**: 检查是否已运行 `install_anaconda.bat`
- 命令行执行 `python --version` 确认环境 ✔️

**Q: 依赖安装失败？** ⚠️

- **A**: 重新运行 `install_anaconda.bat`
- 或手动执行：`pip install -r requirements_anaconda.txt` 🔧

### 使用相关

**Q: 找不到数据文件？** 🔍

- **A**: 确保文件扩展名为 `.txt` 或 `.dcp`
- 检查文件编码为 UTF-8 或 ANSI
- 确认文件未被占用或损坏

**Q: 图表显示异常？** 📊

- **A**: 使用 Chrome/Edge 浏览器打开 HTML
- 检查数据是否包含有效数值
- 查看日志文件了解详细错误

**Q: 界面出现乱码？** 🌐

- **A**: `start.bat` 已自动设置 UTF-8 编码
- 如仍有问题，手动在命令行执行：`chcp 65001`

### 性能相关

**Q: 处理速度慢？** ⏱️

- **A**: 将数据放在本地硬盘（非网络驱动器）
- 关闭其他占用资源的程序
- 分批处理超大数据集（建议<1000文件）

**Q: 内存不足？** 💾

- **A**: 处理大数据集时关闭其他程序
- 分批处理，避免一次加载过多文件
- 建议系统内存 ≥ 8GB

---

💡 **使用建议**：

- 首次使用建议用小批量测试数据验证结果
- 重要数据处理前请先备份原始文件
- 定期清理输出文件夹中的临时文件

🎊 **感谢使用 CP 数据分析工具，祝您分析顺利！**
